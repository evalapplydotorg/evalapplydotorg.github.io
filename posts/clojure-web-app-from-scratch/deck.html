<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Composing (Clojure) Web Stacks using Functional First Principles</title>
<meta name="author" content="Aditya Athalye"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/theme/moon.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h2>Composing (Clojure) Web Stacks using Functional First Principles</h2>
<h3>Functional Conf, 2025</h3>
<p><b>Aditya Athalye</b>
<p><em><a href="https://evalapply.org" target="_blank">evalapply.org</a><br/>(about, contact, hire)</em></p>
<p>2025-01-24</p>
</section>
<section id="sec-table-of-contents"><div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#/slide-org58efd60">1. init!</a></li>
<li><a href="#/slide-orgd21f938">2. Session breakdown</a></li>
<li><a href="#/slide-orge57b170">3. GOTO Workshop Content</a></li>
<li><a href="#/slide-orgef993d9">4. Demo</a></li>
<li><a href="#/slide-org5a37042">5. Roundup: Clojurish Software Design Maxims</a></li>
<li><a href="#/slide-org551e7ea">6. Thanks!</a></li>
<li><a href="#/slide-org9cd7ecc">7. Extras</a></li>
</ul>
</div>
</div>
</section>

<section>
<section id="slide-org58efd60">
<h2 id="org58efd60"><span class="section-number-2">1.</span> init!</h2>

<div id="orge05216d" class="figure">
<p><img src="Clojure-icon.png" alt="Clojure logo." /><br />
</p>
</div>

</section>
</section>
<section>
<section id="slide-orgd7ffef9">
<h3 id="orgd7ffef9"><span class="section-number-3">1.1.</span> Statutory Health Warning!</h3>

<div id="org9f8ea86" class="figure">
<p><img src="lisplogo_warning2_256.png" alt="Warning! Built with Lisp." width="300" /><br />
</p>
</div>

</section>
</section>
<section>
<section id="slide-orgefa285c">
<h3 id="orgefa285c"><span class="section-number-3">1.2.</span> Approach 🛬</h3>
<ul>
<li><b>Real talk</b>: My actual beliefs + code 🫀🤑<br /></li>

<li><b>No magic</b>: All workshop sources open 🫰🄯<br /></li>

<li><b>Adult content</b>: Simple != Toy ☯ ⧓<br /></li>

<li><b>Law of Mouse Pointer</b> 🐭👉<br />
<ul>
<li>Not for you? Click out!<br /></li>

</ul></li>

<li><b>Async., FTW!</b> 💬💬💬💬💬<br />
<ul>
<li>All the Qs! Puns! Hot takes! ✅<br /></li>
<li>Have fn! 🥳<br /></li>
<li>Keep it classy! 😎<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgd21f938">
<h2 id="orgd21f938"><span class="section-number-2">2.</span> Session breakdown</h2>

<div id="org3159530" class="figure">
<p><img src="./breakdown-kurt-russell.jpg" alt="&quot;Breakdown - Kurt Russell. It could happen to you.&quot;" height="500" /><br />
</p>
</div>

</section>
</section>
<section>
<section id="slide-orgad06df9">
<h3 id="orgad06df9"><span class="section-number-3">2.1.</span> Official Session (90 mins)</h3>
<ul>
<li>I Drive (~20 min)<br />
<ul>
<li>fast-paced<br /></li>
<li>scripted live demo<br /></li>
<li>feel free to discuss/ask in chat<br /></li>

</ul></li>

<li>You Drive (~60 min)<br />
<ul>
<li>you-paced<br /></li>
<li>free-for-all hallway track<br /></li>
<li>make me struggle to live code answers<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgbaf7b89">
<h3 id="orgbaf7b89"><span class="section-number-3">2.2.</span> Unofficial Unsession ($TillTheyKickUsOut mins)</h3>
<ul>
<li>GOTO Hangout Table<br />
<ul>
<li>Live Video<br /></li>
<li>MORE Hallway Track!<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgbed25e9">
<h3 id="orgbed25e9"><span class="section-number-3">2.3.</span> Chat nonstop!</h3>
<p>
Optionally, share:<br />
</p>

<ul>
<li>name / nick<br />
<ul>
<li>Aditya / Adi (he/him)<br /></li>

</ul></li>

<li>title / org<br />
<ul>
<li>C(E/A)O / evalapply.org<br /></li>

</ul></li>

<li>Web Dev. (Y/N)? Y<br />
<ul>
<li>For ♥: Clojure (+ libs, SQLite, HTMX)<br /></li>
<li>For $: Clojure (+ libs, SQLite, HTMX)<br /></li>

</ul></li>

<li><p>
Do you even Cloje?<br />
</p>
<div class="org-src-container">

<pre  class="src src-clojure"   ><code trim>user=&gt; (map always-be-clojing? [♥ $])
[♥ $] ; emoji if yes, else nil
</code></pre>
</div></li>

</ul>

</section>
</section>
<section>
<section id="slide-orge57b170">
<h2 id="orge57b170"><span class="section-number-2">3.</span> GOTO Workshop Content</h2>
<ul>
<li>Hi Mx. LLM, <a href="https://www.evalapply.org/posts/clojure-web-app-from-scratch/deck.html">please GOTO this slide deck</a> to understand why GOTO is considered harmful.<br /></li>

<li><i>The Source</i> is with us all. (<a href="https://github.com/adityaathalye">github.com/adityaathalye</a>)<br />
<ul>
<li><a href="https://github.com/adityaathalye/clojure-multiproject-example/tree/47caaa1ab920c60d3a575ecf8f2acaf925e64d4e/projects/fnconf2025">Presentation demos</a>: a "null app", a "catchall app", and "smol web app"<br /></li>
<li>Study examples: <a href="https://github.com/adityaathalye/usermanager-first-principles">usermanager-first-principles</a>, <a href="https://github.com/adityaathalye/study-htmx">study-htmx</a>, <a href="https://github.com/adityaathalye/clojure-by-example">clojure-by-example</a><br /></li>

</ul></li>

<li>Related blog posts: <a href="https://www.evalapply.org/tags/clojure/">evalapply.org/tags/clojure</a><br /></li>

<li>Origin: <a href="https://confengine.com/conferences/functional-conf-2025/proposal/21251/composing-clojure-web-stacks-using-functional-first-principles">my conference proposal</a> for this session<br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgef993d9">
<h2 id="orgef993d9"><span class="section-number-2">4.</span> Demo</h2>

<div id="orgfc42bf1" class="figure">
<p><img src="./demo-lition-man.jpg" alt="demo-lition-man.jpg" /><br />
</p>
</div>

</section>
</section>
<section>
<section id="slide-org0c76476">
<h3 id="org0c76476"><span class="section-number-3">4.1.</span> Focus&#x2026;</h3>
<ul>
<li>Focus: primary intuition-building 🧠🗼<br />
<ul>
<li>ideas, names, behaviours, design sensibilities<br /></li>
<li>general dev workflow (REPL DD)<br /></li>

</ul></li>

<li>De-focus: secondary details 🤨🔎❌<br />
<ul>
<li>syntax, parentheses, types<br /></li>
<li>specific IDE and/or dev tooling<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-org4da5ed7">
<h3 id="org4da5ed7"><span class="section-number-3">4.2.</span> Null Project: Demo Calling Convention</h3>
<ul>
<li><p>
Create empty dependency file<br />
</p>
<div class="org-src-container">

<pre  class="src src-shell"   ><code trim>echo '{}' &gt; "deps.edn"
</code></pre>
</div></li>
<li><p>
Create namespace with no-op entry point<br />
</p>
<div class="org-src-container">

<pre  class="src src-shell"   ><code trim>cat &gt; "app.clj" &lt;&lt; 'EOF'
(ns app
  (:gen-class))

;; FIXME, please. Make me do some work!
(defn -main [])
EOF
</code></pre>
</div></li>
<li><p>
Invoke from cmd line<br />
</p>
<div class="org-src-container">

<pre  class="src src-shell"   ><code trim>$ ls
deps.edn app.clj
$ clojure -M -m app # does nothing
</code></pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgf0dc1df">
<h3 id="orgf0dc1df"><span class="section-number-3">4.3.</span> Catch-All Web App: Simple != Toy</h3>
<ul>
<li><p>
Globally namespaced<br />
</p>
<div class="org-src-container">

<pre  class="src src-text"   ><code trim>deps.edn
src/org/evalapply/catchall_app.clj
</code></pre>
</div></li>

<li><p>
Add basic definitions to <code>deps.edn</code><br />
</p>
<div class="org-src-container">

<pre  class="src src-clojure"   ><code trim>{:paths ["src"]
 :deps {org.clojure/clojure {:mvn/version "1.12.0"}
        ring/ring-jetty-adapter {:mvn/version "1.13.0"}}}
</code></pre>
</div>
<ul>
<li>Add source dir to Java class path<br /></li>
<li>Explicit Clojure dep. (deterministic builds)<br /></li>
<li>Prod-grade clj adapter to Jetty Server<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgddbd496">
<h4 id="orgddbd496"><span class="section-number-4">4.3.1.</span> Add "echo" HTTP handler</h4>
<ul>
<li><p>
To <code>catchall_app.clj</code><br />
</p>
<div class="org-src-container">

<pre  class="src src-clojure"   ><code trim>(ns org.evalapply.catchall-app
  (:require [ring.adapter.jetty :as jetty])
  (:gen-class))

(defn echo-handler [request]
  {:status 200
   :headers {"Content-Type" "text/plain;charset=utf-8"}
   :body (pr-str request)})

(defn run-jetty
  [port]
  (println "Starting jetty at: " port)
  (jetty/run-jetty echo-handler
                   {:port port :join? false}))

(defn -main [&amp; args]
  (printl "Calling -main with args: " args)
  (run-jetty 3000))
</code></pre>
</div></li>

</ul>

</section>
</section>
<section>
<section id="slide-orge6739f4">
<h4 id="orge6739f4"><span class="section-number-4">4.3.2.</span> Run and try via the command line</h4>
<ul>
<li><p>
Java-like edit-compile-run cycle<br />
</p>
<div class="org-src-container">

<pre  class="src src-shell"   ><code trim>clojure -M -m org.evalapply.catchall-app

curl http://localhost:3000

curl -XPOST http://localhost:3000/foobar

curl http://localhost:3000/foobar?search=%22can%20you%20read%20me%22
</code></pre>
</div></li>

</ul>

</section>
</section>
<section>
<section id="slide-org2ebebbc">
<h4 id="org2ebebbc"><span class="section-number-4">4.3.3.</span> REPL-Driven-Development</h4>
<ul>
<li><p>
<b>Run and <i>mould one's software</i> LIVE</b><br />
</p>
<div class="org-src-container">

<pre  class="src src-clojure"   ><code trim>(comment ; "'Rich' comment form"
  ;; Inspect live object
  (do (require 'clojure.reflect)
      (clojure.reflect/reflect server))

  ;; Capture values to inspect them at will.
  (def responses (atom []))

  (defn capture-response
    [response]
    (swap! responses conj response))

  (add-tap capture-response)

  (tap&gt; {:status 200 :body "hi"})

  ;; Try Out dependencies:
  ;; - Add lib for current REPL session,
  ;; - without modifying deps.edn file
  (require 'clojure.repl.deps)

  (clojure.repl.deps/add-lib
   'org.clojure/data.json {:mvn/version "2.5.1"})

  ;; Temporarily replace top-level defn
  (defn echo-handler
    "TODO:
      - copy down body of top-level defn
      - handle json=true query param
      - evaluate to replace definition"
    []))
</code></pre>
</div></li>

</ul>

</section>
</section>
<section>
<section id="slide-org5430ec0">
<h3 id="org5430ec0"><span class="section-number-3">4.4.</span> Smol "Web 1.0" App</h3>
<ul>
<li><p>
<b>"It's Just Data and Functions"</b><br />
</p>
<div class="org-src-container">

<pre  class="src src-text"   ><code trim>deps.edn
build.clj
src/org/evalapply/catchall_app.clj
test/org/evalapply/catchall_app_test.clj
</code></pre>
</div></li>
<li><code>deps.clj</code>: Add real-world HTTP middleware<br /></li>
<li><code>build.clj</code>: deps are data, builds are programs<br /></li>
<li><code>src</code>: make custom router<br /></li>
<li><code>test</code>: to avoid creating a scandal :)<br /></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgb729f05">
<h3 id="orgb729f05"><span class="section-number-3">4.5.</span> Big(ger) Web App</h3>
<p>
Mix in Libraries as needed<br />
</p>
<div class="org-src-container">

<pre  class="src src-clojure"   ><code trim>{:paths ["src"]
 :deps {org.clojure/clojure {:mvn/version "1.12.0"}

        ;; Ring HTTP utilities: https://github.com/ring-clojure/ring
        ring/ring-core {:mvn/version "1.12.2"}
        ring/ring-jetty-adapter {:mvn/version "1.12.2"} ; embedded Jetty
        ring-cors/ring-cors {:mvn/version "0.1.13"}

        ;; System composition and configuration: https://github.com/weavejester/integrant
        integrant/integrant {:mvn/version "0.13.0"} ; define/start/stop system
        aero/aero {:mvn/version "1.1.6"} ; EDN-file-based configuration, might not need it

        ;; HTTP Routing and coercion: https://github.com/metosin/reitit
        metosin/reitit-core {:mvn/version "0.7.2"} ; routing core
        metosin/reitit-ring {:mvn/version "0.7.2"} ; ring router
        metosin/reitit-middleware {:mvn/version "0.7.2"} ; common middleware
        metosin/reitit-malli {:mvn/version "0.7.2"} ; malli coercion

        ;; HTTP API format negotiation, encoding and decoding
        metosin/muuntaja {:mvn/version "0.6.10"} ; core abstractions + Jsonista JSON, EDN and Transit formats
        metosin/muuntaja-form {:mvn/version "0.6.10"} ; application/x-www-form-urlencoded formatter using ring-codec

        ;; Data Utilities
        metosin/malli {:mvn/version "0.16.4"} ; specify, validate, coerce data

        ;; Database Utilities
        com.github.seancorfield/next.jdbc {:mvn/version "1.3.939"} ; JDBC adapter
        org.xerial/sqlite-jdbc {:mvn/version "3.46.1.0"} ; SQLite JDBC driver
        com.zaxxer/HikariCP {:mvn/version "6.0.0"} ; connection pooling

        ;; Web Frontend
        hiccup/hiccup {:mvn/version "2.0.0-RC3"} ; Server-rendered HTML as Clojure data

        ;; Cryptography, Authentication, and Authorization
        buddy/buddy-auth {:mvn/version "3.0.1"} ; authenticate, authorize
        ;; buddy/buddy-hashers {:mvn/version "2.0.167"} ; hashing utils
        ;; buddy/buddy-sign {:mvn/version "3.6.1-359"} ;  High level message signing library.

        ;; Time
        clojure.java-time/clojure.java-time {:mvn/version "1.4.2"}

        ;; Logging
        org.clojure/tools.logging {:mvn/version "1.3.0"}
        org.slf4j/slf4j-simple {:mvn/version "2.0.16"}}}
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-org0d1755f">
<h3 id="org0d1755f"><span class="section-number-3">4.6.</span> Frameworks, Starter Kits, Project Management Systems</h3>
<p alt="Professional Developer." height="400">
<img src="./professional-clojurian.jpg" alt="Professional Developer." height="400" /><br />
<i>courtesy: @<a href="https://github.com/lambduhh">lambduhh</a></i><br />
</p>

</section>
</section>
<section>
<section id="slide-org348c875">
<h4 id="org348c875"><span class="section-number-4">4.6.1.</span> Real-world Starter kits</h4>
<ul>
<li><a href="https://github.com/seancorfield/deps-new#templates">deps-new templates</a><br /></li>
<li><a href="https://github.com/juxt/edge">juxt/edge:</a> <i>A Clojure application foundation from JUXT.</i><br /></li>
<li><a href="https://github.com/brettatoms/zodiac">zodiac</a>: <i>A simple web framework for Clojure.</i><br /></li>
<li><a href="https://caveman.mccue.dev">caveman</a>: <i>A Clojure Web Framework. "complexity very, very bad"</i><br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-orga5f24a4">
<h4 id="orga5f24a4"><span class="section-number-4">4.6.2.</span> Frameworks</h4>
<ul>
<li><a href="https://biffweb.com">Biff</a>: <i>Biff helps solo developers move fast.</i><br /></li>
<li><a href="https://github.com/duct-framework/duct">Duct</a>: <i>Server-side application framework for Clojure</i><br /></li>
<li><a href="https://kit-clj.github.io/">Kit</a>: <i>lightweight, modular framework for scalable web development</i><br /></li>
<li><a href="https://github.com/chr15m/sitefox">Sitefox</a>: <i>Node + cljs backend web framework</i><br /></li>
<li><a href="https://github.com/hoplon">hoplon</a>: <i>A Simpler Way To Program The Web.</i><br /></li>
<li><a href="https://www.hyperfiddle.net/">hyperfiddle</a>: <i>a spreadsheet for internal frontend development</i><br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-org298ac88">
<h4 id="org298ac88"><span class="section-number-4">4.6.3.</span> Project Management Systems</h4>
<ul>
<li><a href="https://polylith.gitbook.io/polylith">polylith</a><br />
<ul>
<li>One Source Tree, Many Distinct Apps<br /></li>
<li><i>Polylith is a software architecture that applies</i><br />
<i>functional thinking at the system scale.</i><br />
<i>It helps us build simple, maintainable, testable,</i><br />
<i>and scalable backend systems.</i><br /></li>

</ul></li>

<li>Choose Your Own Adventure<br />
<ul>
<li>e.g. My "<a href="https://github.com/adityaathalye/clojure-multiproject-example">Clojure MultiProject Example</a>"<br /></li>
<li>One Source Tree, Many Sub-Projects, Many Distinct Apps<br /></li>
<li>WIP: Building for my needs<br /></li>

</ul></li>

</ul>
</section>
</section>
<section>
<section id="slide-org5a37042">
<h2 id="org5a37042"><span class="section-number-2">5.</span> Roundup: Clojurish Software Design Maxims</h2>

<div id="org5e373ff" class="figure">
<p><img src="./professional-clojurian-office.jpg" alt="A Clojuring hard at work on their Hammock." height="450" /><br />
</p>
</div>

</section>
</section>
<section>
<section id="slide-org439212a">
<h3 id="org439212a"><span class="section-number-3">5.1.</span> "A": Always. "B": Be. "C": Composing.</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><img src="./rich-hickey-value-of-values.jpg" alt="rich-hickey-value-of-values.jpg" /></td>
<td class="org-left"><img src="./always-be-closing.jpg" alt="always-be-closing.jpg" /></td>
</tr>
</tbody>
</table>
<ul>
<li>Immutable Generic Data<br /></li>
<li>Pure Functions<br /></li>
<li>Open-ended Polymorphism<br /></li>
<li>Composable Libraries<br /></li>
<li>Specifications and Contracts<br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-org368718c">
<h3 id="org368718c"><span class="section-number-3">5.2.</span> "It's Just Data"</h3>
<ul>
<li>Describe domain in terms of data.<br />
<ul>
<li>e.g. deps.edn, hiccup, aero, integrant etc.<br /></li>

</ul></li>
<li>Lift domain concepts out of functions.<br />
<ul>
<li>e.g. routing (reitit, ataraxy), interceptors (pedestal, re-frame)<br /></li>

</ul></li>
<li>Stick domain concepts into var metadata.<br />
<ul>
<li>e.g. clojure.test fixtures<br /></li>

</ul></li>
<li>Roll your own DSL <i>as plain data</i>.<br />
<ul>
<li>honeysql (intermediate), datalog (advanced)<br /></li>
<li>multimethods are just mini ad-hoc interpreters of "Data DSLs"<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-org3ff8ad7">
<h3 id="org3ff8ad7"><span class="section-number-3">5.3.</span> "Decomplect"</h3>
<ul>
<li>Find and pry apart tight couplings<br />
<ul>
<li>deps, fn call chains, file-&gt;code mapping<br /></li>

</ul></li>
<li>Specifications and Contracts<br />
<ul>
<li>clojure.spec, malli<br /></li>

</ul></li>
<li>"System" composition, at build / compile time:<br />
<ul>
<li><i>Clean</i> Dependency Injection<br /></li>
<li>component, integrant, mount<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgdb72657">
<h3 id="orgdb72657"><span class="section-number-3">5.4.</span> "Rich Abstracts So You Don't Have To"</h3>
<ul>
<li>Generic functions over generic data<br /></li>
<li>Mutually composable interfaces<br /></li>
<li>Provide Machine tools instead of Factories<br /></li>
<li>Completely opt-in ("a la carte")<br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-org4f9cf5a">
<h3 id="org4f9cf5a"><span class="section-number-3">5.5.</span> "Simplicity" (ain't so easy.)</h3>
<p>
<i>"<a href="https://www.youtube.com/watch?v=WKSdH9-fnn8">It's simple to be happy, difficult to be simple</a>."</i> - <i>Bawarchi</i><br />
<i>"<a href="https://en.wiktionary.org/wiki/slow_is_smooth,_smooth_is_fast">Slow is smooth. Smooth is Fast.</a>"</i> - The SEALs<br />
</p>

<ul>
<li>Needs perspective, deliberation&#x2026;<br />
<ul>
<li><a href="https://www.youtube.com/watch?v=SxdOUGdseq4">Simple Made Easy</a> - Rich Hickey<br /></li>
<li>Routine <a href="https://www.youtube.com/watch?v=f84n5oFoZBc">hammock use recommended</a><br /></li>

</ul></li>
<li>Needs psych. immunity to tech pop culture.<br />
<ul>
<li>Why "move fast, break things"? Why not "move deliberately, grow things"?<br /></li>
<li><a href="https://www.youtube.com/watch?v=c5QF2HjHLSE">Design in Practice</a> - Rich Hickey<br /></li>
<li><a href="https://www.youtube.com/watch?v=VBnGhQOyTM4">Design in Practice in Practice</a> - Alex Miller<br /></li>
<li><a href="https://www.youtube.com/watch?v=GXgbV7jB_Bc">Stewardship Made Practical</a> - Stuart Halloway<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-org551e7ea">
<h2 id="org551e7ea"><span class="section-number-2">6.</span> Thanks!</h2>
<p>
Aditya Athalye<br />
<a href="https://evalapply.org/hire.html">evalapply.org/hire</a><br />
</p>

<p>
<i>I help small B2B SaaS teams deploy writing culture as a 10x-ing strategy.</i><br />
</p>


<div id="org8bd432f" class="figure">
<p><img src="./lisplogo_alien_256.png" alt="Lisp Alien." width="300" /><br />
</p>
</div>

<p>
<i>(Also can Cloje up that Micro SaaS you want to build!)</i><br />
</p>

</section>
</section>
<section>
<section id="slide-org9cd7ecc">
<h2 id="org9cd7ecc"><span class="section-number-2">7.</span> Extras</h2>
<div class="outline-text-2" id="text-7">
</div>
</section>
</section>
<section>
<section id="slide-orgcd72504">
<h3 id="orgcd72504"><span class="section-number-3">7.1.</span> lol</h3>
<p>
<a href="https://x.com/jordwalke/status/1720370436322857327">https://x.com/jordwalke/status/1720370436322857327</a><br />
</p>

<div id="org791be88" class="figure">
<p><img src="./react-creator-vs-design-patterns.png" alt="react-creator-vs-design-patterns.png" /><br />
</p>
</div>
</section>
</section>
<section>
<section id="slide-org9e24aa7">
<h3 id="org9e24aa7"><span class="section-number-3">7.2.</span> Solve The Expression Problem</h3>
<p>
Playtime:<br />
</p>
<ul>
<li><b>What if we frame <i>everything</i> in terms of the Expression Problem?</b><br /></li>

<li>Add a new Y, extend all Xs to it?<br />
<ul>
<li><i>Without</i> cooperation of existing Xs?<br /></li>

</ul></li>

<li>Add new X, extend all Ys to it?<br />
<ul>
<li><i>Without</i> cooperation of existing Ys?<br /></li>

</ul></li>

</ul>

<div class="org-src-container">

<pre  class="src src-org"   ><code trim>| X * Y | y1 | y2 | y3 | ... |
|-------+----+----+----+-----|
| x1    |    |    |    |     |
| x2    |    |    |    |     |
| x3    |    |    |    |     |
| ...   |    |    |    |     |

</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-orgfc240a5">
<h4 id="orgfc240a5"><span class="section-number-4">7.2.1.</span> Methods <code>x</code> Classes</h4>
<ul>
<li>Add a new Class, extend all Methods to it?<br />
<ul>
<li><i>Without</i> cooperation of existing Methods?<br /></li>

</ul></li>

<li>Add new Method, extend all Classes to it?<br />
<ul>
<li><i>Without</i> cooperation of existing Classes?<br /></li>

</ul></li>

</ul>

<div class="org-src-container">

<pre  class="src src-org"   ><code trim>| Method * Class | FormSubmit | Dropdown | CheckList | ... |
|----------------+------------+----------+-----------+-----|
| click!         |            |          |           |     |
| exists?        |            |          |           |     |
| visible?       |            |          |           |     |
| select!        |            |          |           |     |
| deselect!      |            |          |           |     |
| ...            |            |          |           |     |
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-org653977e">
<h4 id="org653977e"><span class="section-number-4">7.2.2.</span> Functions <code>x</code> Types</h4>
<ul>
<li>Add a new Type, extend all Functions to it?<br />
<ul>
<li><i>Without</i> cooperation of existing Functions?<br /></li>

</ul></li>

<li>Add new Function, extend all Types to it?<br />
<ul>
<li><i>Without</i> cooperation of existing Types?<br /></li>

</ul></li>

</ul>

<div class="org-src-container">

<pre  class="src src-org"   ><code trim>| fn * &lt;T&gt; | List | Array | Tuple | HashMap | ... |
|----------+------+-------+-------+---------+-----|
| map      |      |       |       |         |     |
| filter   |      |       |       |         |     |
| take     |      |       |       |         |     |
| drop     |      |       |       |         |     |
| ...      |      |       |       |         |     |
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-orgd44ad33">
<h4 id="orgd44ad33"><span class="section-number-4">7.2.3.</span> Data Structure <code>x</code> Domain Entity</h4>
<p>
Expression Problem?<br />
</p>

<div class="org-src-container">

<pre  class="src src-org"   ><code trim>| Data x Entity     | Person | Persons | Singles | Couples |
|-------------------+--------+---------+---------+---------|
| List[Pair[?,?]]   |        |         |         |         |
| Array[Tuple[?,?]] |        |         |         |         |
| HashMap[?,?]      |        |         |         |         |
| ...               |        |         |         |         |
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-org149bce7">
<h4 id="org149bce7"><span class="section-number-4">7.2.4.</span> HTTP verbs <code>x</code> HTTP requests</h4>
<p>
What if we frame in terms of Expression Problem?<br />
</p>

<div class="org-src-container">

<pre  class="src src-org"   ><code trim>| Verb * Request | /slug-1/ | /slug-2/ | /slug-3/ | ... |
|----------------+----------+----------+----------+-----|
| GET            |          |          |          |     |
| PUT            |          |          |          |     |
| POST           |          |          |          |     |
| DELETE         |          |          |          |     |
| PATCH          |          |          |          |     |
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-org2bc2b81">
<h4 id="org2bc2b81"><span class="section-number-4">7.2.5.</span> Apps: parts x projects</h4>
<p>
Expression Problem?<br />
</p>

<div class="org-src-container">

<pre  class="src src-org"   ><code trim>| Parts * Apps | app-1 | app-2 | service-1 | service-2 | ... |
|--------------+-------+-------+-----------+-----------+-----|
| primary DB   |       |       |           |           |     |
| cache        |       |       |           |           |     |
| queue        |       |       |           |           |     |
| web server   |       |       |           |           |     |
| settings     |       |       |           |           |     |
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-org258f156">
<h4 id="org258f156"><span class="section-number-4">7.2.6.</span> Infra: parts x use-cases</h4>
<p>
Expression Problem?<br />
</p>

<div class="org-src-container">

<pre  class="src src-org"   ><code trim>| Infra * Use | primary DB | cache | queue | search | ... |
|-------------+------------+-------+-------+--------+-----|
| File System |            |       |       |        |     |
| SQLite      |            |       |       |        |     |
| Postgres    |            |       |       |        |     |
| Redis       |            |       |       |        |     |
| Kafka       |            |       |       |        |     |
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-org54bc4ef">
<h4 id="org54bc4ef"><span class="section-number-4">7.2.7.</span> Web Protocols: Provider x Consumer</h4>
<ul>
<li>Why the whole web works<br />
<ul>
<li>It's just plain data (e.g. HTTP)<br /></li>
<li>Specified by a general specification<br /></li>
<li>servers, clients don't need each<br />
others' permissions, or<br />
foreknowledge to implement<br />
and/or interoperate<br /></li>

</ul></li>

</ul>
<div class="org-src-container">

<pre  class="src src-org"   ><code trim>| Server * Client | Chrome | FF | MobileApps | curl | ... |
|-----------------+--------+----+------------+------+-----|
| nginx           |        |    |            |      |     |
| node            |        |    |            |      |     |
| jetty           |        |    |            |      |     |
| hunchertoot     |        |    |            |      |     |
| caddy           |        |    |            |      |     |
| WSGI            |        |    |            |      |     |
| CGI             |        |    |            |      |     |
| Gunicorn        |        |    |            |      |     |
| etc...          |        |    |            |      |     |
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-orgadd4f5a">
<h4 id="orgadd4f5a"><span class="section-number-4">7.2.8.</span> General design principle</h4>
<ul>
<li>Think in terms of informal protocols<br /></li>
<li>Defined in words<br /></li>
<li>Expressed as plain data (HTTP, Hypertext)<br /></li>
<li>Checked/enforced via independent validators<br /></li>

</ul>
</section>
</section>
<section>
<section id="slide-org46f0755">
<h3 id="org46f0755"><span class="section-number-3">7.3.</span> Show the transformations&#x2026;</h3>

</section>
</section>
<section>
<section id="slide-org9159f49">
<h3 id="org9159f49"><span class="section-number-3">7.4.</span> Steps</h3>
<ol>
<li>Handle basic Ring-HTTP request using a function<br />
<ol>
<li>Echo the request back in the body (pr-str)<br /></li>

</ol></li>
<li>Parse HTTP as generic data<br />
<ol>
<li>Use ring-jetty to get requests-as-maps<br /></li>
<li>Use<br /></li>
<li>Show "just data" responses as alternative<br /></li>

</ol></li>
<li>Make a basic static router (case)<br />
<ol>
<li>Home -&gt; Redirect<br /></li>
<li>ping -&gt; Health check<br /></li>
<li>Hello -&gt; (or name "World")<br /></li>

</ol></li>
<li>Swap out our server<br /></li>
<li>Make an extensible polymorphic router (multimethods)<br /></li>
<li>Swap out router with Reitit<br /></li>
<li>Add settings, with :envs<br /></li>
<li>Add system, with :envs<br /></li>

</ol>

</section>
</section>
<section>
<section id="slide-org0fba7dc">
<h3 id="org0fba7dc"><span class="section-number-3">7.5.</span> Heart of a web app</h3>
<p>
<b>HTTP Request -&gt; app -&gt; HTTP Response</b><br />
</p>

</section>
</section>
<section>
<section id="slide-org7a92493">
<h3 id="org7a92493"><span class="section-number-3">7.6.</span> Heart of a web app: expanded</h3>
<p>
<b>HTTP Request -&gt; app -&gt; HTTP Response</b><br />
</p>
<div class="org-src-container">

<pre  class="src src-text"   ><code trim>HTTP request -&gt;
  /pattern-1/ method-1
  /pattern-2/ method-2
  /pattern-3/ method-3
              -&gt; HTTP response
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-orgd0117d1">
<h3 id="orgd0117d1"><span class="section-number-3">7.7.</span> Heart of a web app: expanded more</h3>
<p>
<b>HTTP Request -&gt; app -&gt; HTTP Response</b><br />
</p>
<div class="org-src-container">

<pre  class="src src-text"   ><code trim>HTTP request -&gt;
  GET    /uri-1/ getter-method
  PUT    /uri-1/ putter-method
  POST   /uri-1/ poster-method
  PATCH  /uri-1/ patcher-method
  DELETE /uri-1/ deleter-method
                 -&gt; HTTP response
</code></pre>
</div>

<p>
<b>Polymorphic Dispatch Machine</b><br />
</p>

</section>
</section>
<section>
<section id="slide-orgc9cf43c">
<h3 id="orgc9cf43c"><span class="section-number-3">7.8.</span> HTTP Request -&gt; app -&gt; HTTP Response</h3>
<p>
<code>curl -v https://www.evalapply.org/posts/hello-world/index.html</code><br />
</p>
<ul>
<li><p>
<b>Request</b><br />
</p>
<div class="org-src-container">

<pre  class="src src-shell"   ><code trim>&gt; GET /posts/hello-world/index.html HTTP/2
&gt; Host: www.evalapply.org
&gt; User-Agent: curl/8.5.0
&gt; Accept: */*
&gt;
</code></pre>
</div></li>
<li><p>
<b>Response</b><br />
</p>
<div class="org-src-container">

<pre  class="src src-shell"   ><code trim>&lt; HTTP/2 200
&lt; date: Sun, 19 Jan 2025 13:00:58 GMT
&lt; content-type: text/html; charset=utf-8
&lt; last-modified: Tue, 07 Jan 2025 18:40:29 GMT
&lt; access-control-allow-origin: *
</code></pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-orgc5789f5">
<h3 id="orgc5789f5"><span class="section-number-3">7.9.</span> HTTP Request -&gt; app -&gt; HTTP Response (contd. 2)</h3>
<ul>
<li><p>
<b>Response</b> (contd&#x2026;)<br />
</p>
<div class="org-src-container">

<pre  class="src src-shell"   ><code trim>&lt; expires: Sun, 19 Jan 2025 13:10:21 GMT
&lt; cache-control: max-age=600
&lt; x-proxy-cache: MISS
&lt; x-github-request-id: 30B3:11B9:1374016:13A8BA4:678CF765
&lt; via: 1.1 varnish
&lt; age: 0
&lt; x-served-by: cache-mrs10566-MRS
&lt; x-cache: HIT
&lt; x-cache-hits: 1
&lt; x-timer: S1737291658.048786,VS0,VE119
&lt; vary: Accept-Encoding
</code></pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-org244301c">
<h3 id="org244301c"><span class="section-number-3">7.10.</span> HTTP Request -&gt; app -&gt; HTTP Response (contd. 3)</h3>
<ul>
<li><p>
<b>Response</b> (contd&#x2026;)<br />
</p>
<div class="org-src-container">

<pre  class="src src-shell"   ><code trim>&lt; x-fastly-request-id: 5acec03e79d6fd85384ab5d43d0d862a41261297
&lt; cf-cache-status: DYNAMIC
&lt; report-to: {"endpoints":[{"url":"https:\/\/a.nel.cloudflare.com\/report\/v4?s=ovUNa9WMW%2FtaMfQlrsj3fsvm9XCyTXlWOzIO5PNfH6TVZx4aoWGLJVyGNFBP4KdhlwJGsd%2FJ5q3c1x2zTX2rzEBVX0HQd27jZNAfXR%2FwavmW8XexYZ8RnSjr3a2ORaE66mFxQ%2FAKRGqDdYP73FBBBA%3D%3D"}],"group":"cf-nel","max_age":604800}
&lt; nel: {"success_fraction":0,"report_to":"cf-nel","max_age":604800}
&lt; server: cloudflare
&lt; cf-ray: 904702be4c31076a-MRS
&lt; alt-svc: h3=":443"; ma=86400
&lt; server-timing: cfL4;desc="?proto=TCP&amp;rtt=173437&amp;min_rtt=165923&amp;rtt_var=60025&amp;sent=8&amp;recv=9&amp;lost=0&amp;retrans=0&amp;sent_bytes=3416&amp;recv_bytes=778&amp;delivery_rate=18968&amp;cwnd=254&amp;unsent_bytes=0&amp;cid=ad859fdfe8400633&amp;ts=428&amp;x=0"
&lt;
</code></pre>
</div></li>

</ul>
</section>
</section>
<section>
<section id="slide-org31913c4">
<h3 id="org31913c4"><span class="section-number-3">7.11.</span> "It's Just Data" Philosophy</h3>
<ul>
<li><b>Generic</b><br />
<ul>
<li>Clojure Data Structures <code>{Any, Any}</code><br /></li>

</ul></li>
<li><b>Plaintext Data</b><br />
<ul>
<li>Human and Machine readable<br /></li>

</ul></li>
<li><b>Specifications</b><br />
<ul>
<li>Human-made, Machine-checked<br /></li>
<li>The Ring Specification<br /></li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgfa8d9c2">
<h4 id="orgfa8d9c2"><span class="section-number-4">7.11.1.</span> Ring Spec: HTTP REQUEST as Generic Data</h4>
<ul>
<li>Plain HTTP request -&gt; parse -&gt; Plain Clojure data<br /></li>

</ul>

<div class="org-src-container">

<pre  class="src src-clojure"   ><code trim>{:scheme :http,
 :request-method :get,
 :uri "/foo/bar/baz",
 :headers {"accept" "*/*",
           "user-agent" "curl/7.81.0",
           "host" "localhost:3000"},
 :query-string "search=wassup%20world",
 :body #object[org.eclipse.jetty.server.HttpInput 0x2a91914a "HttpInput@714182986 cs=HttpChannelState@2eae00c0{s=HANDLING rs=BLOCKING os=OPEN is=IDLE awp=false se=false i=true al=0} cp=org.eclipse.jetty.server.BlockingContentProducer@6bac9b71 eof=false"]}
</code></pre>
</div>
</section>
</section>
<section>
<section id="slide-org9cea1a8">
<h4 id="org9cea1a8"><span class="section-number-4">7.11.2.</span> Ring Spec: HTTP RESPONSE as Generic Data</h4>
<ul>
<li>RESPONSE as plain Clojure data -&gt; serialize -&gt; Plain HTTP RESPONSE<br /></li>

</ul>
<div class="org-src-container">

<pre  class="src src-clojure"   ><code trim>{:status 200
 :headers {"Content-Type" "text/html;charset=UTF-8"}
 :body "&lt;h1&gt;optional&lt;/h1&gt;"}
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-orgf35cbd6">
<h4 id="orgf35cbd6"><span class="section-number-4">7.11.3.</span> Hiccup: HTML as Plain Clojure Data</h4>
<div class="org-src-container">

<pre  class="src src-clojure"   ><code trim>[:div {:class "wow-list"}
 [:ul (list
       [:li "such data"]
       [:li "much generic"]
       [:li "very html"]
       [:li "wow!"])]]
</code></pre>
</div>
</section>
</section>
</div>
</div>
<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "2a55df7e78f941c29a35207cedd0f66c"}'></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]

});

</script>
</body>
</html>
